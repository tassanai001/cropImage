var app={};!function(){app=angular.module("MainApp",["ngRoute","ngSanitize","ngResource","ngAnimate","mgcrea.ngStrap"]),app.config(["$routeProvider","$locationProvider",function(e,n){n.html5Mode(!1).hashPrefix("!"),e.when("/",{templateUrl:"/views/index.html",controller:"mainCtrl"}).when("/sample",{templateUrl:"/views/sample/sample.html",controller:"sampleCtrl"}).otherwise({redirectTo:"/"})}])}();var spinner={},token="XXX";!function(){toastr.options={closeButton:!1,debug:!1,progressBar:!1,positionClass:"toast-bottom-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var e={lines:11,length:23,width:8,radius:40,corners:1,rotate:9,color:"#FFF",speed:1,trail:50,shadow:!1,hwaccel:!0,zIndex:2e9,top:"50%",left:"50%"},n=null;spinner.show=function(){var t=document.getElementById("spinner");null==n?n=new Spinner(e).spin(t):n.spin(t),$.blockUI({message:null,overlayCSS:{backgroundColor:"#5c5c5c"}})},spinner.hide=function(){var e=document.getElementById("spinner");n.stop(e),$.unblockUI()}}(),function(){app.controller("globalCtrl",["$rootScope","$scope",function(e,n){n.pageData=[{Name:"Home"},{Name:"Sample"}],n.directiveTest="HELLO WORLD",e.images="1495380793494.png",$(".upload-btn").on("click",function(){$("#upload-input").click(),$(".progress-bar").text("0%"),$(".progress-bar").width("0%")}),$("#upload-input").on("change",function(){var n=$(this).get(0).files;if(n.length>0){for(var t=new FormData,a=0;a<n.length;a++){var r=n[a];t.append("uploads[]",r,r.name)}$.ajax({url:"/upload/",type:"POST",data:t,processData:!1,contentType:!1,success:function(n){e.images=n,e.initmainMT()},xhr:function(){var e=new XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var n=e.loaded/e.total;n=parseInt(100*n),$(".progress-bar").text(n+"%"),$(".progress-bar").width(n+"%"),100===n&&$(".progress-bar").html("Done")}},!1),e}})}})}])}(),function(){app.directive("directiveSample",function(){return{restrict:"AEC",replace:!0,require:"ngModel",scope:!0,link:function(e,n,t,a){a.$render=function(){n.empty(),n.append(a.$viewValue)}}}})}(),function(){Date.prototype.addHours=function(e){return this.setHours(this.getHours()+e),this},app.filter("DateTrick",function(){return function(e){if(null!==e){var n=e.addHours(7);return n}return{}}})}(),function(){app.controller("mainCtrl",["$rootScope","$scope","mainService","searchEngineService",function(e,n,t,a){n.activePage=1,n.initMT=function(){t.GetSample().then(function(e){n.testData=e})},n.SubmitKeyword=function(){a.addKeyword({keywords:n.inputkeywords}).then(function(e){console.log(e)})},e.initmainMT=function(){console.log("---------- initmainMT ----------");var t=document.getElementById("image");t.src="uploads/"+e.images;var a=document.querySelectorAll(".preview");n.cropper=new Cropper(t,{ready:function(e,n){var t=this.cloneNode();t.className="",t.style.cssText="display: block;width: 100%;min-width: 0;min-height: 0;max-width: none;max-height: none;",angular.forEach(a,function(e){e.appendChild(t.cloneNode())})},aspectRatio:16/9,crop:function(e){var n=e.detail,t=this.cropper,r=t.getImageData(),o=n.width/n.height;angular.forEach(a,function(e){console.log("elem: ",e);var t=e.getElementsByTagName("img").item(0),a=e.offsetWidth,i=a/o,s=n.width/a;e.style.height=i+"px",t.style.width=r.naturalWidth/s+"px",t.style.height=r.naturalHeight/s+"px",t.style.marginLeft=-n.x/s+"px",t.style.marginTop=-n.y/s+"px"})}}),n.cropper.destroy(),n.cropper.replace(t.src,!1),console.log("555: ")},n.retateImage=function(e){"left"===e?n.cropper.rotate(-45):n.cropper.rotate(45)},n.getCroppedCanvas=function(){n.cropper.getCroppedCanvas({width:160,height:90}),n.cropper.getCroppedCanvas().toBlob(function(n){var t=new FormData;t.append("croppedImage",n),$.ajax({url:"/upload/",method:"POST",data:t,processData:!1,contentType:!1,success:function(n){console.log("Upload success",n),e.images=n,e.initmainMT()},error:function(){console.log("Upload error")}})})}}])}(),function(){app.factory("mainService",["$http","$q",function(e,n){var t={};return t.GetSample=function(){spinner.show();var t=n.defer();return e({method:"GET",url:"/sample"}).success(function(e){spinner.hide(),t.resolve(e)}).error(function(e){spinner.hide(),t.reject(e)}),t.promise},t}])}(),function(){app.controller("sampleCtrl",["$scope","$modal","sampleService",function(e,n,t){e.activePage=2,e.readSampleData=[],e.createSample=function(){t.createSample().then(function(n){"ERROR"!=n?(toastr.success("การบันทึกสำเร็จ","การบันทึกข้อมูล"),e.readSampleData.push(n)):toastr.warning("การบันทึกผิดพลาด"+n,"การบันทึกข้อมูล")})},e.createNewSample=function(){t.createNewSample(e.modalData).then(function(n){"ERROR"!=n?(toastr.success("การบันทึกสำเร็จ","การบันทึกข้อมูล"),e.readSampleData.push(n)):toastr.warning("การปรับปรุงผิดพลาด"+n,"การปรับปรุงผิดพลาด")})},e.modalData={},e.read=function(e,n){t.readSample(e).then(function(e){n(e)})},e.readAllSample=function(){t.readAllSample().then(function(n){"ERROR"!=n?e.readSampleData=n:toastr.warning("การอ่านข้อมูลผิดพลาด"+n,"การอ่านข้อมูลผิดพลาด")})},e.updateSample=function(){var n=e.currentID,a=e.currentIndex;t.updateSample(e.modalData,n).then(function(n){"ERROR"!=n?e.readSampleData[a]=e.modalData:toastr.warning("การปรับปรุงผิดพลาด"+n,"การปรับปรุงผิดพลาด")})},e.deleteConfirm=function(t,a){e.currentID=t,e.currentIndex=a,n({scope:e,template:"/views/sample/modal/sampleConfirm.html",show:!0})},e.deleteSample=function(){var n=e.currentID,a=e.currentIndex;t.deleteSample(n).then(function(n){"ERROR"!=n?e.readSampleData.splice(a,1):toastr.warning("การลบผิดพลาด"+n,"การลบผิดพลาด")})},e.checkData=function(){switch(e.modalMode){case"create":e.createNewSample();break;case"edit":e.updateSample()}},e.showSample=function(t,a,r){e.modalMode=t,e.currentID=a,e.currentIndex=r;var o=n({scope:e,template:"/views/sample/modal/sampleModal.html",show:!1});switch(t){case"create":e.modalData={},e.modalData.readOnly=!1,o.$promise.then(o.show);break;case"show":e.read(a,function(n){"ERROR"!=n?(o.$promise.then(o.show),e.modalData=n,e.modalData.bCreate=JSON.parse(n.bCreate),e.modalData.readOnly=!0):toastr.warning("การอ่านข้อมูลผิดพลาด"+n,"การอ่านข้อมูลผิดพลาด")});break;case"edit":e.read(a,function(n){"ERROR"!=n?(o.$promise.then(o.show),e.modalData=n,e.modalData.bCreate=JSON.parse(n.bCreate),e.modalData.readOnly=!1):toastr.warning("การอ่านข้อมูลผิดพลาด"+n,"การอ่านข้อมูลผิดพลาด")})}}}])}(),function(){app.factory("sampleService",["$http","$q",function(e,n){var t={};return t.createSample=function(){spinner.show();var t=n.defer();return e({method:"GET",url:"/sample/create",contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),t.resolve(e)}).error(function(e){spinner.hide(),t.reject(e)}),t.promise},t.createNewSample=function(t){spinner.show();var a=n.defer();return e({method:"POST",url:"/sample/createnew",contentType:"application/json; charset=utf-8",data:{Name:t.Name,bCreate:t.bCreate},dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),a.resolve(e)}).error(function(e){spinner.hide(),a.reject(e)}),a.promise},t.readAllSample=function(){spinner.show();var t=n.defer();return e({method:"GET",url:"/sample/read",contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),t.resolve(e)}).error(function(e){spinner.hide(),t.reject(e)}),t.promise},t.deleteSample=function(t){spinner.show();var a=n.defer();return e({method:"GET",url:"/sample/delete/"+t,contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),a.resolve(e)}).error(function(e){spinner.hide(),a.reject(e)}),a.promise},t.readSample=function(t){spinner.show();var a=n.defer();return e({method:"GET",url:"/sample/read/"+t,contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),a.resolve(e)}).error(function(e){spinner.hide(),a.reject(e)}),a.promise},t.updateSample=function(t,a){spinner.show();var r=n.defer();return e({method:"POST",url:"/sample/update/"+a,data:{Name:t.Name,bCreate:t.bCreate},contentType:"application/json; charset=utf-8",dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),r.resolve(e)}).error(function(e){spinner.hide(),r.reject(e)}),r.promise},t}])}(),function(){app.factory("searchEngineService",["$http","$q",function(e,n){var t={};return t.addKeyword=function(t){spinner.show();var a=n.defer();return console.log(t),e({method:"POST",url:"/searchengine/addKeyword",contentType:"application/json; charset=utf-8",data:t,dataType:"json",headers:{RequestVerificationToken:token}}).success(function(e){spinner.hide(),a.resolve(e)}).error(function(e){spinner.hide(),a.reject(e)}),a.promise},t}])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbGphdmFzY3JpcHQuanMiXSwibmFtZXMiOlsiYXBwIiwiYW5ndWxhciIsIm1vZHVsZSIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJoYXNoUHJlZml4Iiwid2hlbiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJzcGlubmVyIiwidG9rZW4iLCJ0b2FzdHIiLCJvcHRpb25zIiwiY2xvc2VCdXR0b24iLCJkZWJ1ZyIsInByb2dyZXNzQmFyIiwicG9zaXRpb25DbGFzcyIsIm9uY2xpY2siLCJzaG93RHVyYXRpb24iLCJoaWRlRHVyYXRpb24iLCJ0aW1lT3V0IiwiZXh0ZW5kZWRUaW1lT3V0Iiwic2hvd0Vhc2luZyIsImhpZGVFYXNpbmciLCJzaG93TWV0aG9kIiwiaGlkZU1ldGhvZCIsIm9wdFNwaW5lck1vZGFsIiwibGluZXMiLCJsZW5ndGgiLCJ3aWR0aCIsInJhZGl1cyIsImNvcm5lcnMiLCJyb3RhdGUiLCJjb2xvciIsInNwZWVkIiwidHJhaWwiLCJzaGFkb3ciLCJod2FjY2VsIiwiekluZGV4IiwidG9wIiwibGVmdCIsInNwaW5uZXJPYmoiLCJzaG93Iiwic3Bpbm5lcl9kaXYiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiU3Bpbm5lciIsInNwaW4iLCIkIiwiYmxvY2tVSSIsIm1lc3NhZ2UiLCJvdmVybGF5Q1NTIiwiYmFja2dyb3VuZENvbG9yIiwiaGlkZSIsInN0b3AiLCJ1bmJsb2NrVUkiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwicGFnZURhdGEiLCJOYW1lIiwiZGlyZWN0aXZlVGVzdCIsImltYWdlcyIsIm9uIiwiY2xpY2siLCJ0ZXh0IiwiZmlsZXMiLCJ0aGlzIiwiZ2V0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsImkiLCJmaWxlIiwiYXBwZW5kIiwibmFtZSIsImFqYXgiLCJ1cmwiLCJ0eXBlIiwiZGF0YSIsInByb2Nlc3NEYXRhIiwiY29udGVudFR5cGUiLCJzdWNjZXNzIiwiaW5pdG1haW5NVCIsInhociIsIlhNTEh0dHBSZXF1ZXN0IiwidXBsb2FkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsImxlbmd0aENvbXB1dGFibGUiLCJwZXJjZW50Q29tcGxldGUiLCJsb2FkZWQiLCJ0b3RhbCIsInBhcnNlSW50IiwiaHRtbCIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwicmVwbGFjZSIsInJlcXVpcmUiLCJzY29wZSIsImxpbmsiLCJlbGVtZW50IiwiYXR0ciIsIm5nTW9kZWwiLCIkcmVuZGVyIiwiZW1wdHkiLCIkdmlld1ZhbHVlIiwiRGF0ZSIsInByb3RvdHlwZSIsImFkZEhvdXJzIiwiaCIsInNldEhvdXJzIiwiZ2V0SG91cnMiLCJmaWx0ZXIiLCJpbnB1dCIsIkRhdGVDYWwiLCJtYWluU2VydmljZSIsInNlYXJjaEVuZ2luZVNlcnZpY2UiLCJhY3RpdmVQYWdlIiwiaW5pdE1UIiwiR2V0U2FtcGxlIiwidGhlbiIsInRlc3REYXRhIiwiU3VibWl0S2V5d29yZCIsImFkZEtleXdvcmQiLCJrZXl3b3JkcyIsImlucHV0a2V5d29yZHMiLCJyZXN1bHQiLCJjb25zb2xlIiwibG9nIiwiaW1hZ2UiLCJzcmMiLCJwcmV2aWV3cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJjcm9wcGVyIiwiQ3JvcHBlciIsInJlYWR5IiwicGFyYW0xIiwicGFyYW0yIiwiY2xvbmUiLCJjbG9uZU5vZGUiLCJjbGFzc05hbWUiLCJzdHlsZSIsImNzc1RleHQiLCJmb3JFYWNoIiwiZWxlbSIsImFwcGVuZENoaWxkIiwiYXNwZWN0UmF0aW8iLCJjcm9wIiwiZSIsImRldGFpbCIsImltYWdlRGF0YSIsImdldEltYWdlRGF0YSIsInByZXZpZXdBc3BlY3RSYXRpbyIsImhlaWdodCIsInByZXZpZXdJbWFnZSIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiaXRlbSIsInByZXZpZXdXaWR0aCIsIm9mZnNldFdpZHRoIiwicHJldmlld0hlaWdodCIsImltYWdlU2NhbGVkUmF0aW8iLCJuYXR1cmFsV2lkdGgiLCJuYXR1cmFsSGVpZ2h0IiwibWFyZ2luTGVmdCIsIngiLCJtYXJnaW5Ub3AiLCJ5IiwiZGVzdHJveSIsInJldGF0ZUltYWdlIiwic2lkZSIsImdldENyb3BwZWRDYW52YXMiLCJ0b0Jsb2IiLCJibG9iIiwibWV0aG9kIiwicmVzcG9uc2UiLCJlcnJvciIsImZhY3RvcnkiLCIkaHR0cCIsIiRxIiwidGhpc2ZhY3QiLCJkZWZlciIsInJlc29sdmUiLCJlcnIiLCJyZWplY3QiLCJwcm9taXNlIiwiJG1vZGFsIiwic2FtcGxlU2VydmljZSIsInJlYWRTYW1wbGVEYXRhIiwiY3JlYXRlU2FtcGxlIiwicHVzaCIsIndhcm5pbmciLCJjcmVhdGVOZXdTYW1wbGUiLCJtb2RhbERhdGEiLCJyZWFkIiwiaWQiLCJjYiIsInJlYWRTYW1wbGUiLCJyZWFkQWxsU2FtcGxlIiwidXBkYXRlU2FtcGxlIiwiY3VycmVudElEIiwiaW5kZXgiLCJjdXJyZW50SW5kZXgiLCJkZWxldGVDb25maXJtIiwidGVtcGxhdGUiLCJkZWxldGVTYW1wbGUiLCJzcGxpY2UiLCJjaGVja0RhdGEiLCJtb2RhbE1vZGUiLCJzaG93U2FtcGxlIiwibXlPdGhlck1vZGFsIiwicmVhZE9ubHkiLCIkcHJvbWlzZSIsImJDcmVhdGUiLCJKU09OIiwicGFyc2UiLCJkYXRhVHlwZSIsImhlYWRlcnMiLCJSZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4iLCJvYmoiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLFNBQ0osV0FDUUEsSUFBTUMsUUFBUUMsT0FBTyxXQUFZLFVBQVcsYUFBYyxhQUFjLFlBQWEsbUJBQ3JGRixJQUFJRyxRQUFBLGlCQUFBLG9CQUFPLFNBQVVDLEVBQWdCQyxHQUNqQ0EsRUFBa0JDLFdBQVUsR0FBT0MsV0FBVyxLQUM5Q0gsRUFDQ0ksS0FBSyxLQUNGQyxZQUFhLG9CQUFxQkMsV0FBWSxhQUVqREYsS0FBSyxXQUNGQyxZQUFhLDRCQUE2QkMsV0FBWSxlQUN2REMsV0FDQ0MsV0FBWSxX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aUJmLE9BaEJJSCxJQUNJSixPQUFRLE9BQ1JqRyxJQUFLLGtCQUFrQnNILEVBQ3ZCcEgsTUFBUWxCLEtBQU04SixFQUFJOUosS0FBTXdKLFFBQVNNLEVBQUlOLFNBQ3JDcEksWUFBYSxrQ0FDYnVJLFNBQVUsT0FDVkMsU0FDSUMseUJBQTRCOU0sU0FFakNzRSxRQUFRLFNBQVNILEdBQ2hCcEUsUUFBUTRDLE9BQ1I4SCxFQUFNQyxRQUFRdkcsS0FDZmlHLE1BQU0sU0FBU2pHLEdBQ2RwRSxRQUFRNEMsT0FDUjhILEVBQU1HLE9BQU96RyxLQUVkc0csRUFBTUksU0FHVkwsUUFJZixXQUNJdEwsSUFBSW1MLFFBQVEsdUJBQUEsUUFBQSxLQUF1QixTQUFVQyxFQUFNQyxHQUMvQyxHQUFJQyxLQXdCSixPQXZCQUEsR0FBU3hELFdBQWEsU0FBUzdDLEdBQzNCcEUsUUFBUWlDLE1BQ1IsSUFBSXlJLEdBQVFGLEVBQUdFLE9Ba0JmLE9BakJBckQsU0FBUUMsSUFBSWxELEdBQ1ptRyxHQUNJSixPQUFRLE9BQ1JqRyxJQUFLLDJCQUNMSSxZQUFhLGtDQUNiRixLQUFPQSxFQUNQeUksU0FBVSxPQUNWQyxTQUNJQyx5QkFBNEI5TSxTQUVqQ3NFLFFBQVEsU0FBU0gsR0FDaEJwRSxRQUFRNEMsT0FDUjhILEVBQU1DLFFBQVF2RyxLQUNmaUcsTUFBTSxTQUFTakcsR0FDZHBFLFFBQVE0QyxPQUNSOEgsRUFBTUcsT0FBT3pHLEtBRVZzRyxFQUFNSSxTQUdWTCIsImZpbGUiOiJhbGxqYXZhc2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGFwcCA9IHt9O1xuKGZ1bmN0aW9uKCkge1xuICAgICAgICBhcHAgPSBhbmd1bGFyLm1vZHVsZShcIk1haW5BcHBcIiwgWyduZ1JvdXRlJywgJ25nU2FuaXRpemUnLCAnbmdSZXNvdXJjZScsICduZ0FuaW1hdGUnLCAnbWdjcmVhLm5nU3RyYXAnXSk7XG4gICAgICAgIGFwcC5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyLCAkbG9jYXRpb25Qcm92aWRlcikge1xuICAgICAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKGZhbHNlKS5oYXNoUHJlZml4KCchJyk7XG4gICAgICAgICAgICAkcm91dGVQcm92aWRlclxuICAgICAgICAgICAgLndoZW4oXCIvXCIse1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL2luZGV4Lmh0bWwnLCBjb250cm9sbGVyOiAnbWFpbkN0cmwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLndoZW4oXCIvc2FtcGxlXCIse1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL3NhbXBsZS9zYW1wbGUuaHRtbCcsIGNvbnRyb2xsZXI6ICdzYW1wbGVDdHJsJ1xuICAgICAgICAgICAgfSkub3RoZXJ3aXNlKHtcbiAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiBcIi9cIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbikoKTtcbnZhciBzcGlubmVyID0ge307XG52YXIgdG9rZW4gPSBcIlhYWFwiO1xuKGZ1bmN0aW9uKCkge1xuICAgIHRvYXN0ci5vcHRpb25zID0ge1xuICAgICAgICBcImNsb3NlQnV0dG9uXCI6IGZhbHNlLFxuICAgICAgICBcImRlYnVnXCI6IGZhbHNlLFxuICAgICAgICBcInByb2dyZXNzQmFyXCI6IGZhbHNlLFxuICAgICAgICBcInBvc2l0aW9uQ2xhc3NcIjogXCJ0b2FzdC1ib3R0b20tcmlnaHRcIixcbiAgICAgICAgXCJvbmNsaWNrXCI6IG51bGwsXG4gICAgICAgIFwic2hvd0R1cmF0aW9uXCI6IFwiMzAwXCIsXG4gICAgICAgIFwiaGlkZUR1cmF0aW9uXCI6IFwiMTAwMFwiLFxuICAgICAgICBcInRpbWVPdXRcIjogXCI1MDAwXCIsXG4gICAgICAgIFwiZXh0ZW5kZWRUaW1lT3V0XCI6IFwiMTAwMFwiLFxuICAgICAgICBcInNob3dFYXNpbmdcIjogXCJzd2luZ1wiLFxuICAgICAgICBcImhpZGVFYXNpbmdcIjogXCJsaW5lYXJcIixcbiAgICAgICAgXCJzaG93TWV0aG9kXCI6IFwiZmFkZUluXCIsXG4gICAgICAgIFwiaGlkZU1ldGhvZFwiOiBcImZhZGVPdXRcIlxuICAgIH07XG4gICAgdmFyIG9wdFNwaW5lck1vZGFsID0ge1xuICAgICAgICBsaW5lczogMTEsIC8vIFRoZSBudW1iZXIgb2YgbGluZXMgdG8gZHJhd1xuICAgICAgICBsZW5ndGg6IDIzLCAvLyBUaGUgbGVuZ3RoIG9mIGVhY2ggbGluZVxuICAgICAgICB3aWR0aDogOCwgLy8gVGhlIGxpbmUgdGhpY2tuZXNzXG4gICAgICAgIHJhZGl1czogNDAsIC8vIFRoZSByYWRpdXMgb2YgdGhlIGlubmVyIGNpcmNsZVxuICAgICAgICBjb3JuZXJzOiAxLCAvLyBDb3JuZXIgcm91bmRuZXNzICgwLi4xKVxuICAgICAgICByb3RhdGU6IDksIC8vIFRoZSByb3RhdGlvbiBvZmZzZXRcbiAgICAgICAgY29sb3I6ICcjRkZGJywgLy8gI3JnYiBvciAjcnJnZ2JiXG4gICAgICAgIHNwZWVkOiAxLCAvLyBSb3VuZHMgcGVyIHNlY29uZFxuICAgICAgICB0cmFpbDogNTAsIC8vIEFmdGVyZ2xvdyBwZXJjZW50YWdlXG4gICAgICAgIHNoYWRvdzogZmFsc2UsIC8vIFdoZXRoZXIgdG8gcmVuZGVyIGEgc2hhZG93XG4gICAgICAgIGh3YWNjZWw6IHRydWUsIC8vIFdoZXRoZXIgdG8gdXNlIGhhcmR3YXJlIGFjY2VsZXJhdGlvblxuICAgICAgICAvL2NsYXNzTmFtZTogJ3NwaW5uZXInLCAvLyBUaGUgQ1NTIGNsYXNzIHRvIGFzc2lnbiB0byB0aGUgc3Bpbm5lclxuICAgICAgICB6SW5kZXg6IDJlOSwgLy8gVGhlIHotaW5kZXggKGRlZmF1bHRzIHRvIDIwMDAwMDAwMDApXG4gICAgICAgIHRvcDogJzUwJScsIC8vIFRvcCBwb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnQgaW4gcHhcbiAgICAgICAgbGVmdDogJzUwJScgLy8gTGVmdCBwb3NpdGlvbiByZWxhdGl2ZSB0byBwYXJlbnQgaW4gcHhcbiAgICB9O1xuXG4gICAgdmFyIHNwaW5uZXJPYmogPSBudWxsO1xuICAgIHNwaW5uZXIuc2hvdyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNwaW5uZXJfZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NwaW5uZXInKTtcbiAgICAgICAgaWYgKHNwaW5uZXJPYmogPT0gbnVsbCkge1xuICAgICAgICAgICAgc3Bpbm5lck9iaiA9IG5ldyBTcGlubmVyKG9wdFNwaW5lck1vZGFsKS5zcGluKHNwaW5uZXJfZGl2KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNwaW5uZXJPYmouc3BpbihzcGlubmVyX2Rpdik7XG4gICAgICAgIH1cbiAgICAgICAgJC5ibG9ja1VJKHttZXNzYWdlOiBudWxsLCBvdmVybGF5Q1NTOiB7YmFja2dyb3VuZENvbG9yOiAnIzVjNWM1Yyd9fSk7XG4gICAgfVxuXG4gICAgc3Bpbm5lci5oaWRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3Bpbm5lcl9kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3Bpbm5lcicpO1xuICAgICAgICBzcGlubmVyT2JqLnN0b3Aoc3Bpbm5lcl9kaXYpO1xuICAgICAgICAkLnVuYmxvY2tVSSgpO1xuICAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgIGFwcC5jb250cm9sbGVyKFwiZ2xvYmFsQ3RybFwiLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlKSB7XG4gICAgICAgICRzY29wZS5wYWdlRGF0YSA9IFtcbiAgICAgICAgICAgIHsgTmFtZTogJ0hvbWUnIH0sXG4gICAgICAgICAgICB7IE5hbWU6ICdTYW1wbGUnIH1cbiAgICAgICAgXTtcbiAgICAgICAgJHNjb3BlLmRpcmVjdGl2ZVRlc3QgPSBcIkhFTExPIFdPUkxEXCI7XG4gICAgICAgICRyb290U2NvcGUuaW1hZ2VzID0gXCIxNDk1MzgwNzkzNDk0LnBuZ1wiO1xuXG4gICAgICAgIC8vIFRPRE86IFVwbG9hZCBGaWxlc1xuICAgICAgICAkKCcudXBsb2FkLWJ0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICQoJyN1cGxvYWQtaW5wdXQnKS5jbGljaygpO1xuICAgICAgICAgICAgJCgnLnByb2dyZXNzLWJhcicpLnRleHQoJzAlJyk7XG4gICAgICAgICAgICAkKCcucHJvZ3Jlc3MtYmFyJykud2lkdGgoJzAlJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJyN1cGxvYWQtaW5wdXQnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGZpbGVzID0gJCh0aGlzKS5nZXQoMCkuZmlsZXM7XG4gICAgICAgICAgICBpZiAoZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBmaWxlc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCd1cGxvYWRzW10nLCBmaWxlLCBmaWxlLm5hbWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy91cGxvYWQvJyxcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiBmb3JtRGF0YSxcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc0RhdGE6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmltYWdlcyA9IGRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmluaXRtYWluTVQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgeGhyOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldnQubGVuZ3RoQ29tcHV0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGVyY2VudENvbXBsZXRlID0gZXZ0LmxvYWRlZCAvIGV2dC50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVyY2VudENvbXBsZXRlID0gcGFyc2VJbnQocGVyY2VudENvbXBsZXRlICogMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnByb2dyZXNzLWJhcicpLnRleHQocGVyY2VudENvbXBsZXRlICsgJyUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnByb2dyZXNzLWJhcicpLndpZHRoKHBlcmNlbnRDb21wbGV0ZSArICclJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwZXJjZW50Q29tcGxldGUgPT09IDEwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnByb2dyZXNzLWJhcicpLmh0bWwoJ0RvbmUnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB4aHI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG59KSgpO1xuKGZ1bmN0aW9uKCl7XG4gICAgYXBwLmRpcmVjdGl2ZSgnZGlyZWN0aXZlU2FtcGxlJyxmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQUVDJyxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICAgICAgICBzY29wZTogdHJ1ZSxcbiAgICAgICAgICAgIC8vdGVtcGxhdGUgOiBcIlwiLFxuICAgICAgICAgICAgLy90ZW1wbGF0ZVVybCA6IFwiXCIsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHIsIG5nTW9kZWwpIHtcbiAgICAgICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZW1wdHkoKTtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQobmdNb2RlbC4kdmlld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuKGZ1bmN0aW9uKCkge1xuICAgIERhdGUucHJvdG90eXBlLmFkZEhvdXJzPSBmdW5jdGlvbihoKXtcbiAgICAgICAgdGhpcy5zZXRIb3Vycyh0aGlzLmdldEhvdXJzKCkraCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBhcHAuZmlsdGVyKCdEYXRlVHJpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW5wdXQpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBEYXRlQ2FsID0gaW5wdXQuYWRkSG91cnMoNyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIERhdGVDYWw7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICAgYXBwLmNvbnRyb2xsZXIoXCJtYWluQ3RybFwiLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHNjb3BlLCBtYWluU2VydmljZSwgc2VhcmNoRW5naW5lU2VydmljZSkge1xuICAgICAgICAkc2NvcGUuYWN0aXZlUGFnZSA9IDE7IC8vIEhvbWVcbiAgICAgICAgJHNjb3BlLmluaXRNVCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIG1haW5TZXJ2aWNlLkdldFNhbXBsZSgpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUudGVzdERhdGEgPSBkYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLlN1Ym1pdEtleXdvcmQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWFyY2hFbmdpbmVTZXJ2aWNlLmFkZEtleXdvcmQoeyBrZXl3b3JkczogJHNjb3BlLmlucHV0a2V5d29yZHMgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgICRyb290U2NvcGUuaW5pdG1haW5NVCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiLS0tLS0tLS0tLSBpbml0bWFpbk1UIC0tLS0tLS0tLS1cIik7XG5cbiAgICAgICAgICAgIHZhciBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaW1hZ2VcIik7XG4gICAgICAgICAgICBpbWFnZS5zcmMgPSBcInVwbG9hZHMvXCIgKyAkcm9vdFNjb3BlLmltYWdlcztcbiAgICAgICAgICAgIHZhciBwcmV2aWV3cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucHJldmlld1wiKTtcbiAgICAgICAgICAgICRzY29wZS5jcm9wcGVyID0gbmV3IENyb3BwZXIoaW1hZ2UsIHtcbiAgICAgICAgICAgICAgICByZWFkeTogZnVuY3Rpb24gKHBhcmFtMSwgcGFyYW0yKSB7XG5cblxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmNyb3BwZXIucmVwbGFjZShpbWFnZS5zcmMsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY2xvbmUgPSB0aGlzLmNsb25lTm9kZSgpO1xuICAgICAgICAgICAgICAgICAgICBjbG9uZS5jbGFzc05hbWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBjbG9uZS5zdHlsZS5jc3NUZXh0ID0gKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJkaXNwbGF5OiBibG9jaztcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIndpZHRoOiAxMDAlO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWluLXdpZHRoOiAwO1wiICtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibWluLWhlaWdodDogMDtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heC13aWR0aDogbm9uZTtcIiArXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm1heC1oZWlnaHQ6IG5vbmU7XCJcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHByZXZpZXdzLCBmdW5jdGlvbiAoZWxlbSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChjbG9uZS5jbG9uZU5vZGUoKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYXNwZWN0UmF0aW86IDE2IC8gOSxcbiAgICAgICAgICAgICAgICBjcm9wOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IGUuZGV0YWlsO1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3JvcHBlciA9IHRoaXMuY3JvcHBlcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGltYWdlRGF0YSA9IGNyb3BwZXIuZ2V0SW1hZ2VEYXRhKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcmV2aWV3QXNwZWN0UmF0aW8gPSBkYXRhLndpZHRoIC8gZGF0YS5oZWlnaHQ7XG5cblxuXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChwcmV2aWV3cywgZnVuY3Rpb24gKGVsZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZWxlbTogXCIsIGVsZW0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZpZXdJbWFnZSA9IGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbWdcIikuaXRlbSgwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcmV2aWV3V2lkdGggPSBlbGVtLm9mZnNldFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByZXZpZXdIZWlnaHQgPSBwcmV2aWV3V2lkdGggLyBwcmV2aWV3QXNwZWN0UmF0aW87XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW1hZ2VTY2FsZWRSYXRpbyA9IGRhdGEud2lkdGggLyBwcmV2aWV3V2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtLnN0eWxlLmhlaWdodCA9IHByZXZpZXdIZWlnaHQgKyBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUud2lkdGggPSBpbWFnZURhdGEubmF0dXJhbFdpZHRoIC8gaW1hZ2VTY2FsZWRSYXRpbyArIFwicHhcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByZXZpZXdJbWFnZS5zdHlsZS5oZWlnaHQgPSBpbWFnZURhdGEubmF0dXJhbEhlaWdodCAvIGltYWdlU2NhbGVkUmF0aW8gKyBcInB4XCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2aWV3SW1hZ2Uuc3R5bGUubWFyZ2luTGVmdCA9IC1kYXRhLnggLyBpbWFnZVNjYWxlZFJhdGlvICsgXCJweFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHJldmlld0ltYWdlLnN0eWxlLm1hcmdpblRvcCA9IC1kYXRhLnkgLyBpbWFnZVNjYWxlZFJhdGlvICsgXCJweFwiO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRzY29wZS5jcm9wcGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICRzY29wZS5jcm9wcGVyLnJlcGxhY2UoaW1hZ2Uuc3JjLCBmYWxzZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIjU1NTogXCIpO1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5yZXRhdGVJbWFnZSA9IGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgICAgICAgICBpZiAoc2lkZSA9PT0gXCJsZWZ0XCIpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuY3JvcHBlci5yb3RhdGUoLTQ1KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNyb3BwZXIucm90YXRlKDQ1KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICAvLyBUT0RPIDogZ2V0Q3JvcHBlZFxuICAgICAgICAkc2NvcGUuZ2V0Q3JvcHBlZENhbnZhcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICRzY29wZS5jcm9wcGVyLmdldENyb3BwZWRDYW52YXMoe1xuICAgICAgICAgICAgICAgIHdpZHRoOiAxNjAsXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA5MFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkc2NvcGUuY3JvcHBlci5nZXRDcm9wcGVkQ2FudmFzKCkudG9CbG9iKGZ1bmN0aW9uIChibG9iKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdjcm9wcGVkSW1hZ2UnLCBibG9iKTtcbiAgICAgICAgICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvdXBsb2FkLycsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgICAgIGRhdGE6IGZvcm1EYXRhLFxuICAgICAgICAgICAgICAgICAgICBwcm9jZXNzRGF0YTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBsb2FkIHN1Y2Nlc3MnLCByZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmltYWdlcyA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS5pbml0bWFpbk1UKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnVXBsb2FkIGVycm9yJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24oKXtcbiAgICBhcHAuZmFjdG9yeSgnbWFpblNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsJHEpIHtcbiAgICAgICAgdmFyIHRoaXNmYWN0ID0ge307XG4gICAgICAgIHRoaXNmYWN0LkdldFNhbXBsZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcbiAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAkaHR0cCh7bWV0aG9kOiAnR0VUJywgdXJsOiAnL3NhbXBsZSd9KS5cbiAgICAgICAgICAgICAgICBzdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuXG4gICAgICAgICAgICAgICAgZXJyb3IoZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZXJyKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiB0aGlzZmFjdDtcblxuICAgIH0pO1xufSkoKTtcbihmdW5jdGlvbigpIHtcbiAgICBhcHAuY29udHJvbGxlcignc2FtcGxlQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsICRtb2RhbCwgc2FtcGxlU2VydmljZSkge1xuICAgICAgICAkc2NvcGUuYWN0aXZlUGFnZSA9IDI7IC8vXCJTYW1wbGVcIjtcbiAgICAgICAgJHNjb3BlLnJlYWRTYW1wbGVEYXRhID0gW107XG5cbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tIENyZWF0ZSBTZWN0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAkc2NvcGUuY3JlYXRlU2FtcGxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5jcmVhdGVTYW1wbGUoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IFwiRVJST1JcIikge1xuICAgICAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2Vzcygn4LiB4Liy4Lij4Lia4Lix4LiZ4LiX4Li24LiB4Liq4Liz4LmA4Lij4LmH4LiIJywgJ+C4geC4suC4o+C4muC4seC4meC4l+C4tuC4geC4guC5ieC4reC4oeC4ueC4pScpO1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZFNhbXBsZURhdGEucHVzaChyZXN1bHQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKCfguIHguLLguKPguJrguLHguJnguJfguLbguIHguJzguLTguJTguJ7guKXguLLguJQnICsgcmVzdWx0LCAn4LiB4Liy4Lij4Lia4Lix4LiZ4LiX4Li24LiB4LiC4LmJ4Lit4Lih4Li54LilJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmNyZWF0ZU5ld1NhbXBsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNhbXBsZVNlcnZpY2UuY3JlYXRlTmV3U2FtcGxlKCRzY29wZS5tb2RhbERhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gXCJFUlJPUlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCfguIHguLLguKPguJrguLHguJnguJfguLbguIHguKrguLPguYDguKPguYfguIgnLCAn4LiB4Liy4Lij4Lia4Lix4LiZ4LiX4Li24LiB4LiC4LmJ4Lit4Lih4Li54LilJyk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWFkU2FtcGxlRGF0YS5wdXNoKHJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4m+C4o+C4seC4muC4m+C4o+C4uOC4h+C4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguJvguKPguLHguJrguJvguKPguLjguIfguJzguLTguJTguJ7guKXguLLguJQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLSBSZWFkIFNlY3Rpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAkc2NvcGUubW9kYWxEYXRhID0ge307XG4gICAgICAgICRzY29wZS5yZWFkID0gZnVuY3Rpb24gKGlkLCBjYikge1xuICAgICAgICAgICAgc2FtcGxlU2VydmljZS5yZWFkU2FtcGxlKGlkKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBjYihyZXN1bHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgJHNjb3BlLnJlYWRBbGxTYW1wbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzYW1wbGVTZXJ2aWNlLnJlYWRBbGxTYW1wbGUoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ICE9IFwiRVJST1JcIikge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZFNhbXBsZURhdGEgPSByZXN1bHQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4reC5iOC4suC4meC4guC5ieC4reC4oeC4ueC4peC4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguK3guYjguLLguJnguILguYnguK3guKHguLnguKXguJzguLTguJTguJ7guKXguLLguJQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICAvLyBUT0RPIDogUGFnaW5hdGlvbiBTZXJ2ZXJzaWRlIFJlYWREYXRhXG5cbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgIC8vLy0tLS0tLS0tLS0tLS0gVXBkYXRlIFNlY3Rpb24gLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgJHNjb3BlLnVwZGF0ZVNhbXBsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpZCA9ICRzY29wZS5jdXJyZW50SUQ7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUuY3VycmVudEluZGV4O1xuICAgICAgICAgICAgc2FtcGxlU2VydmljZS51cGRhdGVTYW1wbGUoJHNjb3BlLm1vZGFsRGF0YSwgaWQpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgIT0gXCJFUlJPUlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5yZWFkU2FtcGxlRGF0YVtpbmRleF0gPSAkc2NvcGUubW9kYWxEYXRhO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKCfguIHguLLguKPguJvguKPguLHguJrguJvguKPguLjguIfguJzguLTguJTguJ7guKXguLLguJQnICsgcmVzdWx0LCAn4LiB4Liy4Lij4Lib4Lij4Lix4Lia4Lib4Lij4Li44LiH4Lic4Li04LiU4Lie4Lil4Liy4LiUJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICAvLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLSBEZWxldGUgU2VjdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAkc2NvcGUuZGVsZXRlQ29uZmlybSA9IGZ1bmN0aW9uIChpZCwgaW5kZXgpIHtcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50SUQgPSBpZDtcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50SW5kZXggPSBpbmRleDtcbiAgICAgICAgICAgICRtb2RhbCh7c2NvcGU6ICRzY29wZSwgdGVtcGxhdGU6ICcvdmlld3Mvc2FtcGxlL21vZGFsL3NhbXBsZUNvbmZpcm0uaHRtbCcsIHNob3c6IHRydWV9KTtcbiAgICAgICAgfTtcbiAgICAgICAgJHNjb3BlLmRlbGV0ZVNhbXBsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBpZCA9ICRzY29wZS5jdXJyZW50SUQ7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSAkc2NvcGUuY3VycmVudEluZGV4O1xuXG4gICAgICAgICAgICBzYW1wbGVTZXJ2aWNlLmRlbGV0ZVNhbXBsZShpZCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPSBcIkVSUk9SXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnJlYWRTYW1wbGVEYXRhLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4peC4muC4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguKXguJrguJzguLTguJTguJ7guKXguLLguJQnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICAvLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLS0gT3RoZXIgU2VjdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAkc2NvcGUuY2hlY2tEYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc3dpdGNoICgkc2NvcGUubW9kYWxNb2RlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImNyZWF0ZVwiIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNyZWF0ZU5ld1NhbXBsZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwiZWRpdFwiIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVwZGF0ZVNhbXBsZSgpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuc2hvd1NhbXBsZSA9IGZ1bmN0aW9uICh0eXBlLCBpZCwgaW5kZXgpIHtcbiAgICAgICAgICAgICRzY29wZS5tb2RhbE1vZGUgPSB0eXBlO1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRJRCA9IGlkO1xuICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRJbmRleCA9IGluZGV4O1xuICAgICAgICAgICAgdmFyIG15T3RoZXJNb2RhbCA9ICRtb2RhbCh7c2NvcGU6ICRzY29wZSwgdGVtcGxhdGU6ICcvdmlld3Mvc2FtcGxlL21vZGFsL3NhbXBsZU1vZGFsLmh0bWwnLCBzaG93OiBmYWxzZX0pO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGUnIDpcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhLnJlYWRPbmx5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIG15T3RoZXJNb2RhbC4kcHJvbWlzZS50aGVuKG15T3RoZXJNb2RhbC5zaG93KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnc2hvdycgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZChpZCwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPSBcIkVSUk9SXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteU90aGVyTW9kYWwuJHByb21pc2UudGhlbihteU90aGVyTW9kYWwuc2hvdyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YSA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhLmJDcmVhdGUgPSBKU09OLnBhcnNlKHJlc3VsdC5iQ3JlYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhLnJlYWRPbmx5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ+C4geC4suC4o+C4reC5iOC4suC4meC4guC5ieC4reC4oeC4ueC4peC4nOC4tOC4lOC4nuC4peC4suC4lCcgKyByZXN1bHQsICfguIHguLLguKPguK3guYjguLLguJnguILguYnguK3guKHguLnguKXguJzguLTguJTguJ7guKXguLLguJQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnZWRpdCcgOlxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUucmVhZChpZCwgZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCAhPSBcIkVSUk9SXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBteU90aGVyTW9kYWwuJHByb21pc2UudGhlbihteU90aGVyTW9kYWwuc2hvdyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGFsRGF0YSA9IHJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhLmJDcmVhdGUgPSBKU09OLnBhcnNlKHJlc3VsdC5iQ3JlYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubW9kYWxEYXRhLnJlYWRPbmx5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKCfguIHguLLguKPguK3guYjguLLguJnguILguYnguK3guKHguLnguKXguJzguLTguJTguJ7guKXguLLguJQnICsgcmVzdWx0LCAn4LiB4Liy4Lij4Lit4LmI4Liy4LiZ4LiC4LmJ4Lit4Lih4Li54Lil4Lic4Li04LiU4Lie4Lil4Liy4LiUJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKCl7XG4gICAgYXBwLmZhY3RvcnkoJ3NhbXBsZVNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsJHEpIHtcbiAgICAgICAgdmFyIHRoaXNmYWN0ID0ge307XG4gICAgICAgIHRoaXNmYWN0LmNyZWF0ZVNhbXBsZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzcGlubmVyLnNob3coKTtcbiAgICAgICAgICAgIHZhciBkZWZlciA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9zYW1wbGUvY3JlYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpc2ZhY3QuY3JlYXRlTmV3U2FtcGxlID0gZnVuY3Rpb24ob2JqKXtcbiAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgICAgIHVybDogJy9zYW1wbGUvY3JlYXRlbmV3JyxcbiAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxuICAgICAgICAgICAgICAgIGRhdGE6IHsgTmFtZTogb2JqLk5hbWUsIGJDcmVhdGU6IG9iai5iQ3JlYXRlfSxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkZWZlci5wcm9taXNlO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXNmYWN0LnJlYWRBbGxTYW1wbGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS9yZWFkJyxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpc2ZhY3QuZGVsZXRlU2FtcGxlID0gZnVuY3Rpb24oaWQpe1xuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS9kZWxldGUvJytpZCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ1JlcXVlc3RWZXJpZmljYXRpb25Ub2tlbic6IHRva2VuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRlZmVyLnByb21pc2U7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpc2ZhY3QucmVhZFNhbXBsZSA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgICAgIHNwaW5uZXIuc2hvdygpO1xuICAgICAgICAgICAgdmFyIGRlZmVyID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9zYW1wbGUvcmVhZC8nK2lkLFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuJzogdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzZmFjdC51cGRhdGVTYW1wbGUgPSBmdW5jdGlvbihvYmosaWQpe1xuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgICRodHRwKHtcbiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3NhbXBsZS91cGRhdGUvJytpZCxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogeyBOYW1lOiBvYmouTmFtZSwgYkNyZWF0ZTogb2JqLmJDcmVhdGV9LFxuICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnUmVxdWVzdFZlcmlmaWNhdGlvblRva2VuJzogdG9rZW5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBzcGlubmVyLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZGVmZXIucmVzb2x2ZShkYXRhKTtcbiAgICAgICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBkZWZlci5yZWplY3QoZGF0YSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdGhpc2ZhY3Q7XG5cbiAgICB9KTtcbn0pKCk7XG4oZnVuY3Rpb24oKXtcbiAgICBhcHAuZmFjdG9yeSgnc2VhcmNoRW5naW5lU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwkcSkge1xuICAgICAgICB2YXIgdGhpc2ZhY3QgPSB7fTtcbiAgICAgICAgdGhpc2ZhY3QuYWRkS2V5d29yZCA9IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICAgICAgc3Bpbm5lci5zaG93KCk7XG4gICAgICAgICAgICB2YXIgZGVmZXIgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAkaHR0cCh7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2VhcmNoZW5naW5lL2FkZEtleXdvcmQnLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcsXG4gICAgICAgICAgICAgICAgZGF0YSA6IGRhdGEsXG4gICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdSZXF1ZXN0VmVyaWZpY2F0aW9uVG9rZW4nOiB0b2tlblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHNwaW5uZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUoZGF0YSk7XG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgc3Bpbm5lci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgZGVmZXIucmVqZWN0KGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gdGhpc2ZhY3Q7XG4gICAgfSk7XG59KSgpOyJdfQ==
